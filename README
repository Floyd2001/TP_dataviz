Voici le **README complet** avec toutes les Ã©tapes, y compris la structure Ã  prÃ©parer pour `traitements.csv`, que tu pourras remplir plus tard toi-mÃªme :

---

# ðŸ“˜ README â€“ CrÃ©ation automatique dâ€™un graphe Neo4j Ã  partir des crimes Police/Gendarmerie

## ðŸŽ¯ Objectif

Importer un fichier Excel contenant les enregistrements de crimes/dÃ©lits par service (Police ou Gendarmerie) et par dÃ©partement, puis crÃ©er un **graphe relationnel dans Neo4j** reprÃ©sentant les interactions entre services, dÃ©partements, crimes et annÃ©es.

---

## ðŸ› ï¸ Pipeline dâ€™ingestion

### 1. ðŸ“¥ Lecture et fusion du fichier Excel

* Charger toutes les feuilles de lâ€™Excel (`pandas.ExcelFile`).
* Extraire pour chaque bloc (par annÃ©e) :

  * Le **type de service** (Police ou Gendarmerie),
  * Les **dÃ©partements (CGD/CSP)** avec dans les propriÃ©tÃ©s le terme ,
  * Les **crimes** et sous-catÃ©gories en ligne.
* Normaliser en format long avec colonnes :

  ```
  Crime | Service | DÃ©partement | AnnÃ©e | Nombre | Type_Service
  ```

---

### 2. ðŸ§¼ Nettoyage et transformation

* Supprimer lignes vides, totaux, et noms mal formÃ©s.
* Fusionner les entÃªtes multi-lignes si nÃ©cessaire.
* Garder uniquement les lignes numÃ©riques valides.
* AgrÃ©ger les doublons :

  ```python
  df.groupby(['AnnÃ©e', 'Crime', 'Service', 'DÃ©partement', 'Type_Service'], as_index=False)['Nombre'].sum() ??????
  ```

---

### 3.  Ingestion Neo4j avec Cypher

#### A. Lancer Neo4j Desktop

CrÃ©ation d une base de donnÃ©es locale 

#### B. DÃ©poser les fichiers CSV dans `/import`

#### C. CrÃ©ation des nÅ“uds

```cypher
LOAD CSV WITH HEADERS FROM 'file:///Service.csv' AS row
MERGE (s:Service {nom: row.nom, type: row.type});

LOAD CSV WITH HEADERS FROM 'file:///Crime.csv' AS row
MERGE (c:Crime {nom: row.nom});

LOAD CSV WITH HEADERS FROM 'file:///Annee.csv' AS row
MERGE (a:Annee {val: toInteger(row.val)});

LOAD CSV WITH HEADERS FROM 'file:///Departement.csv' AS row
MERGE (d:Departement {nom: row.nom});
```

Ou alors en un fichier massif? 

#### D. CrÃ©ation des relations

```cypher
// PATROUILLE
LOAD CSV WITH HEADERS FROM 'file:///relations.csv' AS row
MATCH (s:Service {nom: row.service})
MATCH (d:Departement {nom: row.departement})
MERGE (s)-[:PATROUILLE]->(d);

// A_LIEU
LOAD CSV WITH HEADERS FROM 'file:///relations.csv' AS row
MATCH (c:Crime {nom: row.crime})
MATCH (d:Departement {nom: row.departement})
MERGE (c)-[:A_LIEU]->(d);

// A_Ã‰TÃ‰_RÃ‰ALISÃ‰
LOAD CSV WITH HEADERS FROM 'file:///relations.csv' AS row
MATCH (c:Crime {nom: row.crime})
MATCH (a:Annee {val: toInteger(row.annee)})
MERGE (c)-[r:A_Ã‰TÃ‰_RÃ‰ALISÃ‰]->(a)
SET r.nombre = toInteger(row.nombre);
```
// Traite
LOAD CSV WITH HEADERS FROM 'file:///traitements.csv' AS row
MATCH (s:Service {nom: row.service})
MATCH (c:Crime {nom: row.crime})
MERGE (s)-[r:TRAITE {annÃ©e: toInteger(row.annee)}]->(c)
SET r.nombre = toInteger(row.nombre);
```


---

## ðŸ§  Structure finale du graphe

```
(:Service {type}) --[:PATROUILLE]--> (:DÃ©partement)
(:Crime) --[:A_LIEU]--> (:DÃ©partement)
(:Service) --[:TRAITE {annÃ©e, nombre}]--> (:Crime)
```

---
